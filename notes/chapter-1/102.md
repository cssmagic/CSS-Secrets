---
title: "[注解] [102] CSS 编码技巧"
issue: "#30"
---

## 经验分享

#### 如何正确书写回退样式

我们应用利用 CSS 自身的机制来组织回退样式，而不是依赖 CSS hack 来实现。

举个例子，设计师要求某个元素的背景色显示为半透明的黑色，但低版本 IE 等浏览器并不支持 RGBA 颜色，因此对于这些浏览器，我们需要将它的背景色设置为最接近设计意图的纯黑色。那么在这里，半透明黑色是我们期望的 “理想样式”，而纯黑色则是用来兜底的 “回退样式”。

搞清楚了状况之后，我们很快写出了下面的代码：

```stylus
background: rgba(0, 0, 0, 0.75);
background: #000\9;
```

这段代码的意图是这样的：第一条声明是我们理想的样式，写给标准浏览器；第二条声明是专门写给 IE 的 CSS hack，因为只有 IE 浏览器才能识别这一行，所以在 IE 下这个元素的背景色就是黑色的了。

听起来似乎很有道理，现实中也有很多代码是这样写的，但它存在一些明显缺陷：

* 首先，第二行代码命中的是 “IE 浏览器”，但实际上我们希望它命中的是 “不支持 RGBA 的浏览器”。虽然从现状上来说，这两者的相互覆盖率相当高，但代码的作用和我们的实际意图不符，这是一个不小的问题。

* 此外，这种回退样式的写法在 IE6、7、8 当道的年代还算说得通，但当 IE9+ 出现之后就站不住脚了。因为 IE9+ 一方面是支持 RGBA 的，另一方面又可以识别第二条声明，最终导致 IE9+ 也把元素显示为纯黑背景（但它本可以显示出我们理想的效果）。在这里我们也可以看出 CSS Hack 的脆弱之处——没有人能对它的未来兼容性提供担保。

我们不妨换个思路，其实 CSS 有一项非常重要的特性——当浏览器遇到无法识别的某行声明时，会自动忽略。因此，正确的代码组织方式应该是先写回退样式，再写理想样式：

```stylus
background: #000;
background: rgba(0, 0, 0, 0.75);
```

这种写法更像是具备了 “特性检测” 的功效：不支持 RGBA 的浏览器不识别第二条声明，因此只有第一条会生效；而对于支持 RGBA 的浏览器来说，它们可以同时识别这两条声明，但由于第二条权重更高，它们最终将显示出半透明的效果。

（注：当浏览器遇到无法识别的选择符时，会忽略整条规则。）


## 花絮与注解

#### 第 10 页 · 第三段

> 举例来说，要把表单元素的字体设定为与页面的其他部分相同，你并不需要重复指定字体属性，只需利用 `inherit` 的特性即可

“表单元素” 指的是输入框、按钮等元素。

为什么要把表单元素的字体设定为 “与页面的其他部分相同”？为什么表单元素不能自动从祖先元素那里继承字体样式？这是因为在浏览器的默认样式中，通常已经给表单元素指定了字体样式。当一个元素自身已经指定某个属性之后，就无法从祖先元素那里继承了。

#### 第 12 页 · 最后一行

> ——在 Iterations 中实践响应式设计

Iterations 是 Basecamp 公司的一个内部管理工具。

Basecamp 公司原来叫做 37signals，从 2014 年开始改为现在的名字。Basecamp 原来是这家公司的主打产品的名字，后来当产品的名气远远超过公司名气的时候，公司改名也就是顺理成章的事情了。


## 交流与答疑

（暂无）
